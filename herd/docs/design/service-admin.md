# 服务治理和监控相关设计

**注：标记 * 的为和之前有区别的或新增的主要部分**

## 功能说明

- 以企业和公共资源的维度来管理服务（可以被作为服务注册中心的公共资源）*
  注：下面提到的公共资源都是可被作为服务注册中心的公共资源
- 在每个项目中可生成全局唯一 appKey，此 appKey 可通过算法自校验，避免随意填写*

- 添加一个菜单 服务治理
  - 首屏所有内容应该分类与 4 个环境之下*
  - 首屏展示已被标记和分类的公共资源，分类是指此公共资源注册了何种类型的服务（dubbo、hsf、motan...），一个公共资源可有多个分类
  - 首屏提供入口从合法公共资源中选择，进行标记和分类；并且起名和描述
  - 可维护外源应用的 appKey ，帮助外源应用生成 appKey *
  - 点击一个公共资源下面的分类进入服务列表页面
- 服务列表页面 显示单个公共资源下某类型的所有服务
  - 服务可按名称、tag 来筛选，tag 可多选
  - 服务也可按 appKey 来筛选
  - 点击服务进入服务详情页面
- 服务详情页面 主要展示服务基本信息、监控信息和管理功能
  - 服务基本信息包括所属 appKey 、被打的 tag 、服务提供者和调用者 IP
  - 服务监控信息包括被调用次数、响应时间、错误次数
  - 管理功能包括告警设置*、启/禁用、触发链路跟踪、权限管理

## 服务权限说明

服务按 appKey 分组，appKey 按项目维度维护，同一项目中不同应用使用相同的 appKey 。

服务有开放和不开放两种状态，权限按 appKey 黑白名单的方式来维护。当设置为开放时，会拒绝黑名单中的 appKey 的请求；当设置为不开放时，只会通过白名单中的 appKey 的请求。

当调用者和提供者的 appKey 相同时，不进行权限校验，直接通过。

一期不做远端校验，需要各个项目保护好自己的 appKey ，防止恶意冒充。

## 不同角色功能说明

三种角色：企业管理员、项目管理员、普通开发者

- 企业管理员
  - 维护公共资源（标记注册中心）
  - 维护外部项目的 appKey
  - 所有项目管理员可进行的行为
- 项目管理员
  - 生成项目的 appKey
  - 启用/禁用服务（以下所有服务都指属于该项目的）
  - 为服务设置权限
  - 为服务设置告警项（触发条件、通知对象）
  - 开启服务链路跟踪
  - 为项目级别设置全局告警项
  - 所有普通开发者可进行的行为
- 普通开发者
  - 查询服务
  - 查看服务详情
